# 设计说明书

## 1. 项目概述

- **名称**：归物+（GoodsManager）
- **定位**：针对租房青年、摄影/旅行爱好者的个人物品全生命周期管理工具，参考「归物」App 的分层定位思路，强调“登记—定位—借用—洞察—提醒”闭环。
- **目标痛点**：物品多且流转频繁，难以记住位置、价值与借用状态；缺少针对纸质标签/二维码的轻量工具；需要跨场景的整理灵感。

## 2. 需求分析

| 模块 | 核心场景 | 约束 |
| --- | --- | --- |
| 资产总览 | 快速查看物品数、重点件、资产估值，获取整理灵感 | 主面板需在 3 秒内加载本地数据，网络失败有兜底提示 |
| 物品档案 | 新增/编辑物品（分类、位置、标签、价值、保修、备注），支持搜索 | 至少 3 个 Activity；Room 持久化；支持二维码生成 |
| 借用管理 | 记录借出人、联系方式、到期时间；查看列表 | WorkManager 每日检查即将到期并触发通知；可标记归还 |
| 数据洞察 | 分类分布、重点物品、资产估值 | 使用 MPAndroidChart 展示图表 |
| 偏好设置 | 暗色主题、借用提醒开关 | 支持 Material Design 3、暗色主题 |
| 网络能力 | 获取整理灵感 | Retrofit 请求 `https://api.adviceslip.com/advice`，对失败情况做提示 |

## 3. 技术方案

- **架构**：MVVM（ViewModel + LiveData）+ Repository。Application 层提供 `AppContainer` 统一注入。
- **数据层**：
  - `Room`：`ItemEntity`、`BorrowRecordEntity`、`ItemDao`、`BorrowRecordDao`、`GoodsDatabase`。
  - `UserPreferencesRepository`：SharedPreferences 封装暗色/提醒开关。
- **网络层**：Retrofit + OkHttp Logging 拦截器，`TipService` 拉取整理灵感，`ItemRepository` 暴露 `LiveData<Resource<String>>`。
- **提醒**：`BorrowReminderWorker` + `WorkManager` + `NotificationHelper`，每日检查未归还记录。
- **UI 层**：全部 Activity 使用 ViewBinding；RecyclerView + Card + Material3 组件；MPAndroidChart 绘制饼图；ZXing 生成二维码；Glide 提供图片占位。

## 4. 功能实现

1. **主面板** (`MainActivity`)
   - LiveData 订阅统计、最近入库、网络灵感。
   - 卡片式入口跳转物品列表、借用、统计、设置，Fab 新增物品。
2. **物品档案**
   - `ItemListActivity` 搜索与列表；`ItemEditActivity` 支持日期选择、重点标记、QR 数据串写入；`ItemDetailActivity` 展示详情、二维码、分享文本。
3. **借用管理**
   - Detail 页面可添加借用记录；`BorrowManageActivity` 全局列表、标记归还。
4. **统计洞察**
   - `StatisticsActivity` 订阅 `StatisticsViewModel` 数据，生成饼图。
5. **偏好设置**
   - `SettingsActivity` 绑定开关，实时切换暗色主题、提醒开关。

## 5. 创新亮点

- 结合「归物」理念的“位置+标签+二维码”思路，并加入价值统计与借用提醒形成闭环。
- 将网络灵感、资产洞察、借用提醒整合，强调实用性与差异化。
- 采用 WorkManager + Notification 的软实时提醒，保证低功耗。

## 6. 测试与运行

- **环境**：Android Studio Hedgehog、JDK 21、Gradle 8.6.1、compile/target SDK 35、min SDK 24。
- **测试步骤**：
  1. 运行 `./gradlew assembleDebug`；
  2. 真机添加 3 类以上物品，验证搜索、编辑、二维码及借用功能；
  3. 模拟网络断开查看灵感卡片的错误提示；
  4. 通过 `adb shell cmd jobscheduler run ...` 触发 WorkManager 验证提醒通知；
  5. 切换暗色主题与提醒开关验证持久化效果。

## 7. 心得

通过本项目完成了一个围绕真实场景的中型应用，特别是在多模块协同（Room + Retrofit + WorkManager + Material3）方面进行了系统实践，确保满足大作业的创新性、实用性与工程化要求。

